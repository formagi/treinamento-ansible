- hosts: local
  gather_facts: yes
  roles:
    - { role: provisioning-aws, tags: ["provisioning_aws_role"] }
  vars:
    - image: ami-09e67e426f25ce0d7
  
- hosts: all
  become: yes
  gather_facts: no
  pre_tasks:
    - name: 'atualizando o repo'
      raw: 'apt update'
    - name: 'instalando o python'
      raw: 'apt install -y python'
  roles: 
    - { role: install-k8s, tags: ["install_k8s_role"] }

- hosts: k8s-master
  become: yes
  roles:
    - { role: create-cluster, tags: ["create_cluster_role"] }

- hosts: k8s-workers
  become: yes
  roles:
  - { role: join-workers, tags: ["join_workers_role"] }

- hosts: k8s-master
  become: yes
  roles:
  - { role: install-helm, tags: ["install_helm3_role"] }

- hosts: k8s-master
  become: yes
  roles:
  - { role: install-monit-tools, tags: ["install_monit_tools_role"] }